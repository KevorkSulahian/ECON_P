{
    "collab_server" : "",
    "contents" : "library(stringr)\nlibrary(utf8)\nlibrary(ggplot2)\n\nlibrary(dplyr)\nlibrary(writexl)\n\ndf  <- readxl::read_xlsx(\"to_work.xlsx\", sheet = \"Armstat\", col_names = TRUE) #Reading the file\ncolnames(df) <- c('Name','ID','Year','Period','Export_in_tonnas',\n                  'Export','Import_in_tonnas','Import')\n\ndf[,2:8] <- apply(df[,2:8],2,as.numeric)\n\ndf$Export <- df$Export/1000\ndf$Import <- df$Import/1000\nmain  <- readxl::read_xlsx(\"main.xlsx\" ,sheet = \"Sheet1\", col_names = FALSE) \ncolnames(main) <-  c('Name','ID')\nmain$ID<-as.numeric(main$ID)\n\nmain[main$ID==9701 & !(is.na(main$ID)),'Name']  <- \"Ձեռքով արված նկար\"\nmain[main$ID==9702 & !(is.na(main$ID)),'Name']  <- \"Փորագրանկարի, Էստամպի, վինատպության բնօրինակներ\"\nmain[main$ID==9704 & !(is.na(main$ID)),'Name']  <- \"Քանդակների, արձանիկների բնօրինակներ\t\"\nmain[main$ID==9703 & !(is.na(main$ID)),'Name']  <- \"Նամականիշ կամ պետական տուրքի դրոշմանիշ\"\nmain[main$ID==9706 & !(is.na(main$ID)),'Name']  <- \"Հավաքածու կամ հավաքածուի առարկաներ\"\nmain[main$ID==9705 & !(is.na(main$ID)),'Name']  <- \"Հնաոճ իրեր 100ից ավելի տարիքով\"\nrep_main <- data.frame(\"Name\" = rep(main$Name, 11),\"ID\"=rep(main$ID, 11))\nrep_main$Year <- 0\nyear_1 <- data.frame(\"Year\"=c(2007:2017), \"i\"=c(1:11))\nfor (i in c(0:10)){\n  rep_main$Year[(i *1244): ((i+1)*1244)] <- year_1[i+1,\"Year\"]\n}\ntitles <- main[is.na(main$ID),'Name']\ncounter <- 1\nfor (i in c(1:nrow(titles))){\n  titles[i,'Group'] = counter\n  counter = counter +1\n}\ntest1 <- df %>%\n  filter(Year != 2018) %>%\n  group_by(ID,Year) %>%\n  summarise(Export_in_tonnas = sum(Export_in_tonnas),\n            Export = sum(Export),\n            Import_in_tonnas = sum(Import_in_tonnas),\n            Import = sum(Import))\n\n\n\ntest2 <- left_join(rep_main, test1, by = c(\"ID\",\"Year\"))\ntest2[4:7][is.na(test2[4:7])] <- 0\ncounter <- 0\n\nfor (i in c(1:nrow(test2))){\n  if ((i-1)%%1244==0) {\n    counter = 0\n  }\n  if (is.na(test2[i,'ID'])) {\n    counter = counter +1\n  }\n  test2[i,'Group'] = counter\n}\n\nunique(test2$Group)\n\ncat <- test2 %>%\n  group_by(Group, Year) %>%\n  summarise(Export_in_tonnas1 = sum(Export_in_tonnas),\n            Export1 = sum(Export),\n            Import_in_tonnas1 = sum(Import_in_tonnas),\n            Import1 = sum(Import))\n\ntest3 <- left_join(titles, cat, by = \"Group\")\ntest3['Group'] <- NULL\ntest2$Name <- as.character(test2$Name)\nfinal <- left_join(test2,test3, by = c(\"Name\",\"Year\"))\n\nfor (i in c(1:nrow(final))){\n  if (is.na(final[i,'ID'])){\n    final[i,4:7] <- final[i,9:12]\n  }\n}\nfinal <- final[,-c(8:12)]\nids <- c(101)\ntemp  <- final[final$ID %in% c(ids),c(\"Import_in_tonnas\",\"Year\",\"ID\")]\nggplot(temp) +\n  geom_point(aes(x=temp[,2],y=temp[,1]), color=\"Red\")+\n  geom_line(aes(x=temp[,2],y=temp[,1])) + \n  scale_x_discrete(name =\"Year\",limits=c(2007:2017))\n# ids <- c(202,203,204)\n# a <- list()\n# a <- ggplot()\n# for (i in c(1:length(ids))){\n#   \n#   a[[i]] <- final[final$ID %in% c(ids[i]),c(\"Import_in_tonnas\",\"Year\",\"ID\")]\n#   \n#   p <- p + geom_point(aes(x=a[[k]]$Year,y=a[[k]]$Import_in_tonnas),colour=\"Red\")+\n#     geom_line(aes(x=a[[k]]$Year,y=a[[k]]$Import_in_tonnas))\n#   print(p)\n#   Sys.sleep(1)\n# }\n# }\n# p <- ggplot()\n# \n# \n# p <-   p + geom_point(aes(x=a[[1]]$Year,y=a[[1]]$Import_in_tonnas),colour=\"Red\")+\n#     geom_line(aes(x=a[[1]]$Year,y=a[[1]]$Import_in_tonnas)) \n# p <- p +    geom_point(aes(x=a[[2]]$Year,y=a[[2]]$Import_in_tonnas),colour=\"Red\")+\n#     geom_line(aes(x=a[[2]]$Year,y=a[[2]]$Import_in_tonnas))\n\np\n# a1 <- final[final$ID %in% c(202),c(\"Import_in_tonnas\",\"Year\",\"ID\")]\n# b1 <- final[final$ID %in% c(203),c(\"Import_in_tonnas\",\"Year\",\"ID\")]\n# test <- ggplot() + geom_point(aes(x=a1$Year,y=a1$Import_in_tonnas),colour=\"Red\")+\n#   geom_line(aes(x=a1$Year,y=a1$Import_in_tonnas))\n# test <- test + geom_point(aes(x=b1$Year,y=b1$Import_in_tonnas),colour=\"Blue\")+\n#   geom_line(aes(x=b1$Year,y=b1$Import_in_tonnas))\n# test\n\n",
    "created" : 1537969431566.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "166941660",
    "id" : "9A4ABE2B",
    "lastKnownWriteTime" : 1538142490,
    "last_content_update" : 1538142490391,
    "path" : "~/Desktop/Min Economy/Final Project/plots.R",
    "project_path" : "plots.R",
    "properties" : {
        "tempName" : "Untitled2"
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}