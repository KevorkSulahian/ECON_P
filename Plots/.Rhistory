scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+550))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'stack') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'stack') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+550))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'stack') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'stack') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+550))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'stack') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'stack') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+51111111111150))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1) +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0)) +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+550))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+11150))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("import.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here2)
dev.off()
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+100))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
library(shiny)
library(stringr)
library(utf8)
library(ggplot2)
library(shinyjs)
library(shinydashboard)
library(rsconnect)
runApp(
list(
ui = dashboardPage(
dashboardHeader(),
dashboardSidebar( fileInput('file1', 'Choose xlsx file',
accept = c(".xlsx")),
selectInput('Exp_imp','Export or Import',
choices = c("Export","Import"))),
dashboardBody(
# fluidRow(
# tags$hr(),
plotOutput("graph")
# )
))
,
server = shinyServer(function(input, output) {
my_data <- reactive({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df  <- readxl::read_xlsx(inFile$datapath, sheet = 1, col_names = TRUE) #Reading the file
df  <- readxl::read_xlsx("Import graph.xlsx", sheet = 1, col_names = TRUE) #Reading the file
colnames(df) <-c("Name", "Price","Growth")
df$Price <- as.numeric(df$Price)
df$Growth <- as.numeric(df$Growth)
df <- df[!(df$Price<0),]
df$Price <- as.numeric(df$Price)
df<-df[order(df$Price),]
df$Price <- round(df$Price, 1)
df$Name <- trimws(df$Name)
df$Name <-as.factor(df$Name)
df$Name <- factor(df$Name,levels= df$Name)
df$Growth <- as.numeric(df$Growth)
df$Price <- round(as.numeric(df$Price),1)
return(df)
})
# output$contents <- renderTable({
#
#   my_data()
# })
output$graph <- renderPlot({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df <- my_data()
if (input$Exp_imp == "Export"){
# adding res
# print("here")
# png("export.png", height = 2480, width = 3508 ,res = 500)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#042900',alpha=1) +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#03561C",alpha=0.5 ,
size=ifelse(df$Growth<0,1,0)) +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","DarkGreen"),
size=10,fontface="bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+50))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("export.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here)
dev.off()
}
else {
# png("import.png", units = "in", height = 4.5, width = 11.25, res = 100)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price," ", round(df$Growth,1)),paste0(Price," ", round(df$Growth,1))),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+100))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("import.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here2)
dev.off()
}
})
})
))
library(shiny)
library(stringr)
library(utf8)
library(ggplot2)
library(shinyjs)
library(shinydashboard)
library(rsconnect)
runApp(
list(
ui = dashboardPage(
dashboardHeader(),
dashboardSidebar( fileInput('file1', 'Choose xlsx file',
accept = c(".xlsx")),
selectInput('Exp_imp','Export or Import',
choices = c("Export","Import"))),
dashboardBody(
# fluidRow(
# tags$hr(),
plotOutput("graph")
# )
))
,
server = shinyServer(function(input, output) {
my_data <- reactive({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df  <- readxl::read_xlsx(inFile$datapath, sheet = 1, col_names = TRUE) #Reading the file
df  <- readxl::read_xlsx("Import graph.xlsx", sheet = 1, col_names = TRUE) #Reading the file
colnames(df) <-c("Name", "Price","Growth")
df$Price <- as.numeric(df$Price)
df$Growth <- as.numeric(df$Growth)
df <- df[!(df$Price<0),]
df$Price <- as.numeric(df$Price)
df<-df[order(df$Price),]
df$Price <- round(df$Price, 1)
df$Name <- trimws(df$Name)
df$Name <-as.factor(df$Name)
df$Name <- factor(df$Name,levels= df$Name)
df$Growth <- as.numeric(df$Growth)
df$Price <- round(as.numeric(df$Price),1)
return(df)
})
# output$contents <- renderTable({
#
#   my_data()
# })
output$graph <- renderPlot({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df <- my_data()
if (input$Exp_imp == "Export"){
# adding res
# print("here")
# png("export.png", height = 2480, width = 3508 ,res = 500)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#042900',alpha=1) +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#03561C",alpha=0.5 ,
size=ifelse(df$Growth<0,1,0)) +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","DarkGreen"),
size=10,fontface="bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+50))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("export.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here)
dev.off()
}
else {
# png("import.png", units = "in", height = 4.5, width = 11.25, res = 100)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+100))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("import.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here2)
dev.off()
}
})
})
))
library(shiny)
library(stringr)
library(utf8)
library(ggplot2)
library(shinyjs)
library(shinydashboard)
library(rsconnect)
runApp(
list(
ui = dashboardPage(
dashboardHeader(),
dashboardSidebar( fileInput('file1', 'Choose xlsx file',
accept = c(".xlsx")),
selectInput('Exp_imp','Export or Import',
choices = c("Export","Import"))),
dashboardBody(
# fluidRow(
# tags$hr(),
plotOutput("graph")
# )
))
,
server = shinyServer(function(input, output) {
my_data <- reactive({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df  <- readxl::read_xlsx(inFile$datapath, sheet = 1, col_names = TRUE) #Reading the file
# df  <- readxl::read_xlsx("Import graph.xlsx", sheet = 1, col_names = TRUE) #Reading the file
colnames(df) <-c("Name", "Price","Growth")
df$Price <- as.numeric(df$Price)
df$Growth <- as.numeric(df$Growth)
df <- df[!(df$Price<0),]
df$Price <- as.numeric(df$Price)
df<-df[order(df$Price),]
df$Price <- round(df$Price, 1)
df$Name <- trimws(df$Name)
df$Name <-as.factor(df$Name)
df$Name <- factor(df$Name,levels= df$Name)
df$Growth <- as.numeric(df$Growth)
df$Price <- round(as.numeric(df$Price),1)
return(df)
})
# output$contents <- renderTable({
#
#   my_data()
# })
output$graph <- renderPlot({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df <- my_data()
if (input$Exp_imp == "Export"){
# adding res
# print("here")
# png("export.png", height = 2480, width = 3508 ,res = 500)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#042900',alpha=1) +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#03561C",alpha=0.5 ,
size=ifelse(df$Growth<0,1,0)) +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","DarkGreen"),
size=10,fontface="bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+50))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("export.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here)
dev.off()
}
else {
# png("import.png", units = "in", height = 4.5, width = 11.25, res = 100)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+100))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("import.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here2)
dev.off()
}
})
})
))
library(shiny)
library(stringr)
library(utf8)
library(ggplot2)
library(shinyjs)
library(shinydashboard)
library(rsconnect)
runApp(
list(
ui = dashboardPage(
dashboardHeader(),
dashboardSidebar( fileInput('file1', 'Choose xlsx file',
accept = c(".xlsx")),
selectInput('Exp_imp','Export or Import',
choices = c("Export","Import"))),
dashboardBody(
# fluidRow(
# tags$hr(),
plotOutput("graph")
# )
))
,
server = shinyServer(function(input, output) {
my_data <- reactive({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df  <- readxl::read_xlsx(inFile$datapath, sheet = 1, col_names = TRUE) #Reading the file
# df  <- readxl::read_xlsx("Import graph.xlsx", sheet = 1, col_names = TRUE) #Reading the file
colnames(df) <-c("Name", "Price","Growth")
df$Price <- as.numeric(df$Price)
df$Growth <- as.numeric(df$Growth)
df <- df[!(df$Price<0),]
df$Price <- as.numeric(df$Price)
df<-df[order(df$Price),]
df$Price <- round(df$Price, 1)
df$Name <- trimws(df$Name)
df$Name <-as.factor(df$Name)
df$Name <- factor(df$Name,levels= df$Name)
df$Growth <- as.numeric(df$Growth)
df$Price <- round(as.numeric(df$Price),1)
return(df)
})
# output$contents <- renderTable({
#
#   my_data()
# })
output$graph <- renderPlot({
inFile <- input$file1
if (is.null(inFile))
return(NULL)
df <- my_data()
if (input$Exp_imp == "Export"){
# adding res
# print("here")
# png("export.png", height = 2480, width = 3508 ,res = 500)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#042900',alpha=1) +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#03561C",alpha=0.5 ,
size=ifelse(df$Growth<0,1,0)) +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","DarkGreen"),
size=10,fontface="bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+50))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("export.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here)
dev.off()
}
else {
# png("import.png", units = "in", height = 4.5, width = 11.25, res = 100)
ggplot(df,aes(x=df$Name))  +
geom_bar(aes(y=df$Price),stat="identity", fill='#186866',alpha=1, position = 'identity') +
geom_bar(aes(y=(df$Price - df$Growth)),stat="identity", fill="#16D1CC",alpha=0.25 ,
size=ifelse(df$Growth<0,1,0), position = 'identity') +
geom_text(aes(label=ifelse(df$Growth<0,paste0(Price,"  (", round(df$Growth,1),")"),paste0(Price,"  (", round(df$Growth,1),")")),
y=ifelse(df$Growth<0, Price-Growth, Price)),hjust= -0.5, color= ifelse(df$Growth<0,"Red","#186866"),
size=10,fontface = "bold")+
scale_y_continuous(breaks = seq(0,max(df$Price)+100,50), limits = c(0, max(df$Price)+100))+
theme_minimal() +
theme(
plot.title = element_blank(),
axis.title.x = element_blank(),
axis.title.y = element_blank(),
axis.text.y = element_text(size=26,face="bold"),
axis.text.x = element_text(size=22,face="bold"))  +
coord_flip()
ggsave("import.png", width = 40, height = 15, dpi = 250, units = "in")
# return(here2)
dev.off()
}
})
})
))
